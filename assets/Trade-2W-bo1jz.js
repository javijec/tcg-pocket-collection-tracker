import{j as e,T as H,r as o,U as J,C as Q,o as W,A as k,ay as E,az as X,B as N,aA as Z}from"./index-DjcYiVW5.js";import{C as v,a as ee}from"./CardDetail-iQqi48Z1.js";import{T as re,a as ae,b as T,R as se,N as F,c as M}from"./RarityFilter-Cpt9MHN2.js";import{A as f,a as g,b}from"./alert-B_iSi12z.js";import{S as h}from"./index-Bp2U-oRL.js";import"./Card-CNC5Muzz.js";function ne(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(f,{className:"mb-8 border-1 border-neutral-700 shadow-none",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx(g,{children:"You have all tradeable cards!"}),e.jsx(b,{children:"Make sure you come back here when new rarities and packs are available for trade."})]})})}function oe(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(f,{className:"mb-8 border-1 border-neutral-700 shadow-none",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx(g,{children:"You have no sellable cards!"}),e.jsx(b,{children:"If you believe you have sellable cards, go to the collections page and input your collected cards to see what you can sell."})]})})}function te(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(f,{className:"mb-8 border-1 border-neutral-700 shadow-none",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx(g,{children:"You have no tradeable cards!"}),e.jsx(b,{children:"Go to the collections page and input your collected cards to see what you can trade."})]})})}function ie(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(f,{className:"mb-8 border-1 border-neutral-700 shadow-none",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx(g,{children:"Sign up to view your tradeable cards"}),e.jsx(b,{children:"By registering, you can keep track of your collection, trade with other users, and access exclusive features."})]})})}function pe(){const A=H(),{user:D,account:n,setIsProfileDialogOpen:L}=o.use(J),{ownedCards:l,selectedCardId:R,setSelectedCardId:B}=o.use(Q),[d,V]=o.useState([]),[j,K]=o.useState(0),[y,P]=o.useState(2),[C,U]=o.useState(3),[u,Y]=o.useState("looking_for"),S=o.useMemo(()=>W.filter(r=>r.tradeable).map(r=>r.id),[]),_=r=>d.length===0?!0:r.rarity!==""&&d.includes(r.rarity),x=o.useMemo(()=>k.filter(r=>l.findIndex(a=>a.card_id===r.card_id)===-1||l[l.findIndex(a=>a.card_id===r.card_id)].amount_owned<=j).filter(r=>E[r.rarity]!==null&&S.includes(r.expansion)),[l,j]),w=o.useMemo(()=>x.filter(_),[x,d]),m=o.useMemo(()=>{const r=l.filter(a=>a.amount_owned>=y);return k.filter(a=>r.findIndex(t=>t.card_id===a.card_id)>-1).map(a=>{var t;return{...a,amount_owned:(t=r.find(i=>i.card_id===a.card_id))==null?void 0:t.amount_owned}}).filter(a=>E[a.rarity]!==null&&S.includes(a.expansion))},[l,y]),$=o.useMemo(()=>m.filter(_),[m,d]),p=o.useMemo(()=>{const r=l.filter(a=>a.amount_owned>=C);return k.filter(a=>r.findIndex(t=>t.card_id===a.card_id)>-1).map(a=>{var t;return{...a,amount_owned:(t=r.find(i=>i.card_id===a.card_id))==null?void 0:t.amount_owned}}).filter(a=>X[a.rarity]!==null)},[l,C]),O=o.useMemo(()=>p.filter(_),[p,d]),z=()=>{let r="";n!=null&&n.is_public&&(r+=`Public trade page: https://tcgpocketcollectiontracker.com/#/collection/${n==null?void 0:n.friend_id}/trade
`),n!=null&&n.username&&(r+=`Friend ID: ${n.friend_id} (${n.username})

`),r+=`Looking for cards:
`;const a=w.sort((s,c)=>{const I=s.expansion.localeCompare(c.expansion);return I!==0?I:s.rarity.localeCompare(c.rarity)});for(let s=0;s<a.length;s++)(s>0?a[s-1].expansion:"")!==a[s].expansion&&(r+=`
${a[s].set_details}:
`),r+=`${a[s].rarity} ${a[s].card_id} - ${a[s].name}
`;const t=w.map(s=>s.rarity);r+=`

For trade cards:
`;const i=$.filter(s=>t.includes(s.rarity)).sort((s,c)=>s.rarity.localeCompare(c.rarity));for(let s=0;s<i.length;s++)(s>0?i[s-1].expansion:"")!==i[s].expansion&&(r+=`
${i[s].set_details}:
`),r+=`${i[s].rarity} ${i[s].card_id} - ${i[s].name}
`;return r},G=async()=>{const r=z();Z({title:"Copied cards for trading to clipboard!",variant:"default",duration:3e3}),await navigator.clipboard.writeText(r)},q=()=>{L(!0)};return D?e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsxs(re,{defaultValue:u,onValueChange:r=>Y(r),children:[e.jsxs("div",{className:"mx-auto max-w-[900px] flex flex-row flex-wrap align-center gap-x-4 gap-y-2 px-4",children:[e.jsxs(ae,{className:"flex-grow m-auto flex-wrap h-auto border-1 border-neutral-700 rounded-md",children:[e.jsx(T,{value:"looking_for",children:"Looking For"}),e.jsx(T,{value:"for_trade",children:"For Trade"}),e.jsx(T,{value:"buying_tokens",children:"Buying Tokens"})]}),e.jsx(se,{rarityFilter:d,setRarityFilter:V}),e.jsxs("div",{className:"sm:mt-1 flex flex-row flex-wrap align-center gap-x-4 gap-y-1",children:[u==="looking_for"&&e.jsx(F,{numberFilter:j,setNumberFilter:K,options:[0,1,2,3,4,5],labelKey:"maxNum"}),u==="for_trade"&&e.jsx(F,{numberFilter:y,setNumberFilter:P,options:[2,3,4,5],labelKey:"minNum"}),u==="buying_tokens"&&e.jsx(F,{numberFilter:C,setNumberFilter:U,options:[2,3,4,5],labelKey:"minNum"}),e.jsx(N,{variant:"outline",onClick:()=>G(),children:"Copy to clipboard"}),n!=null&&n.is_public?e.jsx(N,{variant:"outline",onClick:()=>A(`/collection/${n==null?void 0:n.friend_id}/trade`),children:"Open trading page"}):e.jsx(N,{variant:"outline",onClick:()=>q(),children:"Enable trading page"})]})]}),e.jsxs("div",{className:"mx-auto max-w-[900px] ",children:[e.jsx(M,{value:"looking_for",children:x&&x.length>0?e.jsx(v,{cards:w}):e.jsx(ne,{})}),e.jsx(M,{value:"for_trade",children:m&&m.length>0?e.jsx(v,{cards:$}):e.jsx(te,{})}),e.jsx(M,{value:"buying_tokens",children:p&&p.length>0?e.jsx(v,{cards:O}):e.jsx(oe,{})})]})]}),e.jsx(ee,{cardId:R,onClose:()=>B("")})]}):e.jsx(ie,{})}export{pe as default};

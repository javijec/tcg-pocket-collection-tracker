import{j as e,V as Y,r as s,U as O,C as P,q,E as w,az as v,Q as z,B as F}from"./index-DxUZuhlo.js";import{C as N}from"./CardsTable-C_axf-Qr.js";import{T as G,a as Q,b as _,R as $,N as C,c as k}from"./RarityFilter-CDw5tDvh.js";import{A as x,a as m,b as f}from"./alert-C63jw3i5.js";import{S as g}from"./siren-D13Jt2J0.js";import"./Card-CEGxwZ2f.js";function H(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(x,{className:"mb-8 border-1 border-neutral-700 shadow-none",children:[e.jsx(g,{className:"h-4 w-4"}),e.jsx(m,{children:"You have all tradeable cards!"}),e.jsx(f,{children:"Make sure you come back here when new rarities and packs are available for trade."})]})})}function J(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(x,{className:"mb-8 border-1 border-neutral-700 shadow-none",children:[e.jsx(g,{className:"h-4 w-4"}),e.jsx(m,{children:"You have no sellable cards!"}),e.jsx(f,{children:"If you believe you have sellable cards, go to the collections page and input your collected cards to see what you can sell."})]})})}function W(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(x,{className:"mb-8 border-1 border-neutral-700 shadow-none",children:[e.jsx(g,{className:"h-4 w-4"}),e.jsx(m,{children:"You have no tradeable cards!"}),e.jsx(f,{children:"Go to the collections page and input your collected cards to see what you can trade."})]})})}function X(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(x,{className:"mb-8 border-1 border-neutral-700 shadow-none",children:[e.jsx(g,{className:"h-4 w-4"}),e.jsx(m,{children:"Sign up to view your tradeable cards"}),e.jsx(f,{children:"By registering, you can keep track of your collection, trade with other users, and access exclusive features."})]})})}function te(){const M=Y(),{user:S,account:o,setIsProfileDialogOpen:I}=s.use(O),{ownedCards:t}=s.use(P),[i,R]=s.useState([]),[b,B]=s.useState(0),[h,E]=s.useState(2),[j,A]=s.useState(3),[l,D]=s.useState("looking_for"),T=s.useMemo(()=>q.filter(a=>a.tradeable).map(a=>a.id),[]),p=a=>i.length===0?!0:a.rarity!==""&&i.includes(a.rarity),d=s.useMemo(()=>w.filter(a=>t.findIndex(r=>r.card_id===a.card_id)===-1||t[t.findIndex(r=>r.card_id===a.card_id)].amount_owned<=b).filter(a=>v[a.rarity]!==null&&T.includes(a.expansion)),[t,b]),L=s.useMemo(()=>d.filter(p),[d,i]),c=s.useMemo(()=>{const a=t.filter(r=>r.amount_owned>=h);return w.filter(r=>a.findIndex(n=>n.card_id===r.card_id)>-1).map(r=>{var n;return{...r,amount_owned:(n=a.find(y=>y.card_id===r.card_id))==null?void 0:n.amount_owned}}).filter(r=>v[r.rarity]!==null&&T.includes(r.expansion))},[t,h]),K=s.useMemo(()=>c.filter(p),[c,i]),u=s.useMemo(()=>{const a=t.filter(r=>r.amount_owned>=j);return w.filter(r=>a.findIndex(n=>n.card_id===r.card_id)>-1).map(r=>{var n;return{...r,amount_owned:(n=a.find(y=>y.card_id===r.card_id))==null?void 0:n.amount_owned}}).filter(r=>z[r.rarity]!==null)},[t,j]),U=s.useMemo(()=>u.filter(p),[u,i]),V=()=>{I(!0)};return S?e.jsx("div",{className:"flex flex-col gap-y-4",children:e.jsxs(G,{defaultValue:l,onValueChange:a=>D(a),children:[e.jsxs("div",{className:"mx-auto max-w-[900px] flex flex-row flex-wrap align-center gap-x-4 gap-y-2 px-4",children:[e.jsxs(Q,{className:"flex-grow m-auto flex-wrap h-auto border-1 border-neutral-700 rounded-md",children:[e.jsx(_,{value:"looking_for",children:"Looking For"}),e.jsx(_,{value:"for_trade",children:"For Trade"}),e.jsx(_,{value:"buying_tokens",children:"Buying Tokens"})]}),e.jsx($,{rarityFilter:i,setRarityFilter:R}),e.jsxs("div",{className:"sm:mt-1 flex flex-row flex-wrap align-center gap-x-4 gap-y-1",children:[l==="looking_for"&&e.jsx(C,{numberFilter:b,setNumberFilter:B,options:[0,1,2,3,4,5],labelKey:"maxNum"}),l==="for_trade"&&e.jsx(C,{numberFilter:h,setNumberFilter:E,options:[2,3,4,5],labelKey:"minNum"}),l==="buying_tokens"&&e.jsx(C,{numberFilter:j,setNumberFilter:A,options:[2,3,4,5],labelKey:"minNum"}),o!=null&&o.is_public?e.jsx(F,{variant:"outline",onClick:()=>M(`/collection/${o==null?void 0:o.friend_id}/trade`),children:"Open trading page"}):e.jsx(F,{variant:"outline",onClick:()=>V(),children:"Enable trading page"})]})]}),e.jsxs("div",{className:"mx-auto max-w-[900px] ",children:[e.jsx(k,{value:"looking_for",children:d&&d.length>0?e.jsx(N,{cards:L}):e.jsx(H,{})}),e.jsx(k,{value:"for_trade",children:c&&c.length>0?e.jsx(N,{cards:K}):e.jsx(W,{})}),e.jsx(k,{value:"buying_tokens",children:u&&u.length>0?e.jsx(N,{cards:U}):e.jsx(J,{})})]})]})}):e.jsx(X,{})}export{te as default};

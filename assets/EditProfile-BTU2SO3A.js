import{T as N,r as w,U as T,a$ as y,u as C,b0 as S,b1 as P,b2 as b,j as e,D as k,t as E,v as U,x as A,z as c,B as p,b3 as B}from"./index-DjcYiVW5.js";import{A as I,a as $,b as L}from"./alert-B_iSi12z.js";import{u as R,F as z,a as n,b as d,c as o,d as m,e as x,f,S as H,g as M,s as q}from"./SocialShareButtons-CqsKGW26.js";import{S as G}from"./index-Bp2U-oRL.js";import"./index-BQdT0jya.js";const W=({account:s,setAccount:g,isProfileDialogOpen:u,setIsProfileDialogOpen:j})=>{const v=N(),{user:a}=w.use(T),{toast:h}=y(),{t:r}=C("edit-profile"),_=S({username:b().min(2,{message:"Username must be at least 2 characters."}),friend_id:b().regex(/^[0-9]{16}$/,{message:"Friend ID is not valid, it must be 16 digits without dashes."}),is_public:P().optional()}),t=R({resolver:q(_),values:{username:(s==null?void 0:s.username)||"",friend_id:(s==null?void 0:s.friend_id)||"",is_public:(s==null?void 0:s.is_public)||!1}}),D=async i=>{try{const l=await B.from("accounts").upsert({email:a==null?void 0:a.user.email,username:i.username,friend_id:i.friend_id,is_public:i.is_public}).select().single();g(l.data),h({title:"Account saved.",variant:"default"})}catch(l){console.error("error saving account",l),h({title:"Error saving your account.",variant:"destructive"})}},F=`https://tcgpocketcollectiontracker.com/#/collection/${s==null?void 0:s.friend_id}`;return e.jsx(k,{open:u,onOpenChange:j,children:e.jsxs(E,{className:"border-1 border-neutral-700 shadow-none h-[90vh] content-start",children:[e.jsx(U,{children:e.jsx(A,{children:r("editProfile")})}),e.jsxs(I,{className:"mb-2 border-1 border-neutral-700 shadow-none",children:[e.jsx(G,{className:"h-4 w-4"}),e.jsx($,{children:r("updateProfile.title")}),e.jsx(L,{children:r("updateProfile.description")})]}),e.jsx(z,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(D),className:"space-y-8",children:[e.jsx(n,{name:"email",render:()=>e.jsxs(d,{children:[e.jsx(o,{children:r("email")}),e.jsx(m,{className:"mt-2",children:e.jsx(c,{placeholder:"Email",disabled:!0,value:a==null?void 0:a.user.email})}),e.jsx(x,{children:r("registeredEmail")})]})}),e.jsx(n,{control:t.control,name:"username",render:({field:i})=>e.jsxs(d,{children:[e.jsx(o,{children:r("username")}),e.jsx(m,{className:"mt-2",children:e.jsx(c,{placeholder:"Username",...i})}),e.jsx(x,{children:r("usernameDescription")}),e.jsx(f,{})]})}),e.jsx(n,{control:t.control,name:"friend_id",render:({field:i})=>e.jsxs(d,{children:[e.jsx(o,{children:r("friendID")}),e.jsx(m,{className:"mt-2",children:e.jsx(c,{placeholder:"Friend ID",...i})}),e.jsx(x,{children:r("friendIDDescription")}),e.jsx(f,{})]})}),e.jsx(n,{control:t.control,name:"is_public",render:({field:i})=>e.jsxs(d,{className:"flex flex-col items-start",children:[e.jsx(m,{className:"mt-2",children:e.jsxs("div",{className:"flex items-center gap-x-2 w-full flex-wrap",children:[e.jsx(o,{children:r("isPublicToggle")}),e.jsx("div",{className:"grow-1",children:e.jsx(H,{checked:i.value,onCheckedChange:i.onChange})}),e.jsx(p,{disabled:!(s!=null&&s.is_public),onClick:async l=>{l.preventDefault(),h({title:"Copied public collection page URL to clipboard!",variant:"default",duration:3e3}),await navigator.clipboard.writeText(F)},children:r("isPublicButton")}),e.jsx(p,{disabled:!(s!=null&&s.is_public),onClick:async l=>{l.preventDefault(),j(!1),v(`/collection/${s==null?void 0:s.friend_id}/trade`)},children:r("isPublicTradeButton")})]})}),e.jsx(x,{children:r("isPublicDescription")})]})}),(s==null?void 0:s.is_public)&&e.jsx(M,{}),e.jsx(p,{type:"submit",children:r("save")})]})})]})})};export{W as default};

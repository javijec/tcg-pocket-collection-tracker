import{u as D,_ as E,Z as S,r as i,z as T,O as w,j as e,E as O,F as H,G as I,H as U,J as P}from"./index-iSrh-v3v.js";import{S as R}from"./SocialShareButtons-CfGJVuOn.js";import{N as v}from"./RarityFilter-BNBp73OR.js";import"./index-CS58KSiK.js";const p=["◊","◊◊","◊◊◊","◊◊◊◊","☆"],z=({ownedCards:d,friendCards:c,ownCollection:j})=>{const{t:r}=D("trade-matches"),m=E(),_=S(),[N,g]=i.useState(!1),[x,y]=i.useState(0),[u,F]=i.useState(2);i.useEffect(()=>{m.pathname.includes("/collection")&&m.pathname.includes("/trade")?N||g(!0):g(!1)},[m]);const b=i.useMemo(()=>T.filter(s=>s.tradeable).map(s=>s.id),[]),h=i.useMemo(()=>{const s={"◊":[],"◊◊":[],"◊◊◊":[],"◊◊◊◊":[],"☆":[],"☆☆":[],"☆☆☆":[],"✵":[],"✵✵":[],"Crown Rare":[],Unknown:[],"":[]},t=c.filter(a=>a.amount_owned>=2),l=new Set(d.filter(a=>a.amount_owned>x).map(a=>a.card_id)),o=t.filter(a=>!l.has(a.card_id));for(const a of o){const n=w(a.card_id);n&&p.includes(n.rarity)&&b.includes(n.expansion)&&s[n.rarity].push({...n,amount_owned:a.amount_owned})}return s},[d,c,x,u]),f=i.useMemo(()=>{const s={"◊":[],"◊◊":[],"◊◊◊":[],"◊◊◊◊":[],"☆":[],"☆☆":[],"☆☆☆":[],"✵":[],"✵✵":[],"Crown Rare":[],Unknown:[],"":[]},t=d.filter(a=>a.amount_owned>=u),l=new Set(c.filter(a=>a.amount_owned>0).map(a=>a.card_id)),o=t.filter(a=>!l.has(a.card_id));for(const a of o){const n=w(a.card_id);n&&p.includes(n.rarity)&&b.includes(n.expansion)&&s[n.rarity].push({...n,amount_owned:a.amount_owned})}return s},[d,c,x,u]),C=i.useMemo(()=>p.some(s=>h[s].length>0&&f[s].length>0),[h,f]),M=()=>j?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-xl text-gray-500",children:r("ownCollection")}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:r("ownCollectionDescription")})]}):C?p.map(s=>h[s].length>0&&f[s].length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:s}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium mb-2",children:r("friendHas")}),e.jsx("div",{className:"border rounded p-2 max-h-60 overflow-y-auto",children:e.jsx("ul",{className:"space-y-1",children:h[s].map(t=>{var l;return e.jsxs("li",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"min-w-14 me-4",children:t.card_id}),e.jsx("div",{children:t.name})]}),e.jsxs("span",{title:"Amount you own",className:"text-gray-500",children:["×",((l=d.find(o=>o.card_id===t.card_id))==null?void 0:l.amount_owned)||0]})]},t.card_id)})})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium mb-2",children:r("youHave")}),e.jsx("div",{className:"border rounded p-2 max-h-60 overflow-y-auto",children:e.jsx("ul",{className:"space-y-1",children:f[s].map(t=>e.jsxs("li",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"min-w-14 me-4",children:t.card_id}),e.jsx("div",{children:t.name})]}),e.jsxs("span",{title:"Amount your friend owns",className:"text-gray-500",children:["×",t.amount_owned]})]},t.card_id))})})]})]})]},s)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-xl text-gray-500",children:r("noPossibleTrades")}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:r("noPossibleTradesDescription")})]});return e.jsx(O,{open:N,onOpenChange:s=>{s||_(m.pathname.replace("/trade",""))},children:e.jsxs(H,{className:"border-2 border-slate-600 shadow-none max-w-4xl h-[90vh] content-start flex flex-col",children:[e.jsx(I,{children:e.jsx(U,{children:r("title")})}),e.jsxs("div",{className:"flex flex-col gap-4 grow",children:[e.jsx("p",{className:"pb-2",children:r("featureDescription")}),e.jsxs("div",{className:"flex flex-row gap-4 mb-4 justify-between",children:[e.jsx("div",{children:e.jsx(v,{numberFilter:x,setNumberFilter:y,options:[0,1,2,3,4,5],labelKey:"maxNum"})}),e.jsx("div",{children:e.jsx(v,{numberFilter:u,setNumberFilter:F,options:[2,3,4,5],labelKey:"minNum"})})]}),M()]}),j&&e.jsx(P,{children:e.jsx(R,{})})]})})};export{z as default};

import{j as e,r as t,U as X,C as q,a2 as H,z as J,L as k,a3 as E,X as Q,D as v}from"./index-BGqoxF3F.js";import{T as W,a as Z,b as N,c as T,C as F}from"./tabs-tK4yU67j.js";import{R as ee,N as M}from"./RarityFilter-BKjRjROF.js";import{A as f,a as g,b}from"./alert-BXgGDB8P.js";import{S as h}from"./siren-CVCCtbGy.js";import"./Card-PpxKs908.js";function re(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(f,{className:"mb-8 border-2 border-slate-600 shadow-none",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx(g,{children:"You have all tradeable cards!"}),e.jsx(b,{children:"Make sure you come back here when new rarities and packs are available for trade."})]})})}function ae(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(f,{className:"mb-8 border-2 border-slate-600 shadow-none",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx(g,{children:"You have no sellable cards!"}),e.jsx(b,{children:"If you believe you have sellable cards, go to the collections page and input your collected cards to see what you can sell."})]})})}function se(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(f,{className:"mb-8 border-2 border-slate-600 shadow-none",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx(g,{children:"You have no tradeable cards!"}),e.jsx(b,{children:"Go to the collections page and input your collected cards to see what you can trade."})]})})}function ne(){return e.jsx("article",{className:"mx-auto grid max-w-4xl gap-5",children:e.jsxs(f,{className:"mb-8 border-2 border-slate-600 shadow-none",children:[e.jsx(h,{className:"h-4 w-4"}),e.jsx(g,{children:"Sign up to view your tradeable cards"}),e.jsx(b,{children:"By registering, you can keep track of your collection, trade with other users, and access exclusive features."})]})})}function ue(){const{user:I,account:n,setIsProfileDialogOpen:R}=t.use(X),{ownedCards:l}=t.use(q),{toast:S}=H(),[d,U]=t.useState([]),[y,V]=t.useState(0),[j,A]=t.useState(2),[C,B]=t.useState(3),[u,K]=t.useState("looking_for"),$=t.useMemo(()=>J.filter(r=>r.tradeable).map(r=>r.id),[]),w=r=>d.length===0?!0:r.rarity!=="Unknown"&&r.rarity!==""&&d.includes(r.rarity),x=t.useMemo(()=>k.filter(r=>l.findIndex(a=>a.card_id===r.card_id)===-1||l[l.findIndex(a=>a.card_id===r.card_id)].amount_owned<=y).filter(r=>E[r.rarity]!==null&&$.includes(r.expansion)),[l,y]),_=t.useMemo(()=>x.filter(w),[x,d]),m=t.useMemo(()=>{const r=l.filter(a=>a.amount_owned>=j);return k.filter(a=>r.findIndex(o=>o.card_id===a.card_id)>-1).map(a=>{var o;return{...a,amount_owned:(o=r.find(i=>i.card_id===a.card_id))==null?void 0:o.amount_owned}}).filter(a=>E[a.rarity]!==null&&$.includes(a.expansion))},[l,j]),L=t.useMemo(()=>m.filter(w),[m,d]),p=t.useMemo(()=>{const r=l.filter(a=>a.amount_owned>=C);return k.filter(a=>r.findIndex(o=>o.card_id===a.card_id)>-1).map(a=>{var o;return{...a,amount_owned:(o=r.find(i=>i.card_id===a.card_id))==null?void 0:o.amount_owned}}).filter(a=>Q[a.rarity]!==null)},[l,C]),P=t.useMemo(()=>p.filter(w),[p,d]),Y=()=>{let r="";n!=null&&n.is_public&&(r+=`Public trade page: https://tcgpocketcollectiontracker.com/#/collection/${n==null?void 0:n.friend_id}/trade
`),n!=null&&n.username&&(r+=`Friend ID: ${n.friend_id} (${n.username})

`),r+=`Looking for cards:
`;const a=_.sort((s,c)=>{const D=s.expansion.localeCompare(c.expansion);return D!==0?D:s.rarity.localeCompare(c.rarity)});for(let s=0;s<a.length;s++)(s>0?a[s-1].expansion:"")!==a[s].expansion&&(r+=`
${a[s].set_details}:
`),r+=`${a[s].rarity} ${a[s].card_id} - ${a[s].name}
`;const o=_.map(s=>s.rarity);r+=`

For trade cards:
`;const i=L.filter(s=>o.includes(s.rarity)).sort((s,c)=>s.rarity.localeCompare(c.rarity));for(let s=0;s<i.length;s++)(s>0?i[s-1].expansion:"")!==i[s].expansion&&(r+=`
${i[s].set_details}:
`),r+=`${i[s].rarity} ${i[s].card_id} - ${i[s].name}
`;return r},z=async r=>{r.preventDefault();const a=Y();S({title:"Copied cards for trading to clipboard!",variant:"default",duration:3e3}),await navigator.clipboard.writeText(a)},G=async r=>{r.preventDefault(),S({title:"Copied trading page URL to clipboard!",variant:"default",duration:3e3}),await navigator.clipboard.writeText(`https://tcgpocketcollectiontracker.com/#/collection/${n==null?void 0:n.friend_id}/trade`)},O=()=>{R(!0)};return I?e.jsx("div",{className:"flex flex-col gap-y-4",children:e.jsxs(W,{defaultValue:u,onValueChange:r=>K(r),children:[e.jsxs("div",{className:"mx-auto max-w-[900px] flex flex-row flex-wrap align-center gap-x-4 gap-y-2 px-4",children:[e.jsxs(Z,{className:"flex-grow m-auto flex-wrap h-auto border-2 border-slate-600 rounded-md",children:[e.jsx(N,{value:"looking_for",children:"Looking For"}),e.jsx(N,{value:"for_trade",children:"For Trade"}),e.jsx(N,{value:"buying_tokens",children:"Buying Tokens"})]}),e.jsx(ee,{rarityFilter:d,setRarityFilter:U}),e.jsxs("div",{className:"sm:mt-1 flex flex-row flex-wrap align-center gap-x-4 gap-y-1",children:[u==="looking_for"&&e.jsx(M,{numberFilter:y,setNumberFilter:V,options:[0,1,2,3,4,5],labelKey:"maxNum"}),u==="for_trade"&&e.jsx(M,{numberFilter:j,setNumberFilter:A,options:[2,3,4,5],labelKey:"minNum"}),u==="buying_tokens"&&e.jsx(M,{numberFilter:C,setNumberFilter:B,options:[2,3,4,5],labelKey:"minNum"}),e.jsx(v,{variant:"outline",onClick:r=>z(r),children:"Copy to clipboard"}),n!=null&&n.is_public?e.jsx(v,{variant:"outline",onClick:r=>G(r),children:"Share trading page"}):e.jsx(v,{variant:"outline",onClick:()=>O(),children:"Enable trading page"})]})]}),e.jsxs("div",{className:"mx-auto max-w-[900px] ",children:[e.jsx(T,{value:"looking_for",children:x&&x.length>0?e.jsx(F,{cards:_}):e.jsx(re,{})}),e.jsx(T,{value:"for_trade",children:m&&m.length>0?e.jsx(F,{cards:L}):e.jsx(se,{})}),e.jsx(T,{value:"buying_tokens",children:p&&p.length>0?e.jsx(F,{cards:P}):e.jsx(ae,{})})]})]})}):e.jsx(ne,{})}export{ue as default};

import{Q as N,r as w,U as C,ag as S,u as y,ah as n,j as e,D as P,v as T,x as k,y as A,A as p,B as j,ai as E}from"./index-B1PLXRbD.js";import{A as U,a as B,b as I}from"./alert-DAiM17F4.js";import{u as $,F as L,a as d,b as o,c as m,d as x,e as h,f,S as R,g as z,s as H}from"./SocialShareButtons-ChFcqIVk.js";import{S as M}from"./siren-B5VUsPGR.js";import"./index-K1T9Lsjb.js";const O=({account:s,setAccount:g,isProfileDialogOpen:u,setIsProfileDialogOpen:b})=>{const v=N(),{user:a}=w.use(C),{toast:c}=S(),{t:r}=y("edit-profile"),_=n.object({username:n.string().min(2,{message:"Username must be at least 2 characters."}),friend_id:n.string().regex(/^[0-9]{16}$/,{message:"Friend ID is not valid, it must be 16 digits without dashes."}),is_public:n.boolean().optional()}),t=$({resolver:H(_),values:{username:(s==null?void 0:s.username)||"",friend_id:(s==null?void 0:s.friend_id)||"",is_public:(s==null?void 0:s.is_public)||!1}}),D=async i=>{try{const l=await E.from("accounts").upsert({email:a==null?void 0:a.user.email,username:i.username,friend_id:i.friend_id,is_public:i.is_public}).select().single();g(l.data),c({title:"Account saved.",variant:"default"})}catch(l){console.error("error saving account",l),c({title:"Error saving your account.",variant:"destructive"})}},F=`https://tcgpocketcollectiontracker.com/#/collection/${s==null?void 0:s.friend_id}`;return e.jsx(P,{open:u,onOpenChange:b,children:e.jsxs(T,{className:"border-1 border-neutral-700 shadow-none h-[90vh] content-start",children:[e.jsx(k,{children:e.jsx(A,{children:r("editProfile")})}),e.jsxs(U,{className:"mb-2 border-1 border-neutral-700 shadow-none",children:[e.jsx(M,{className:"h-4 w-4"}),e.jsx(B,{children:r("updateProfile.title")}),e.jsx(I,{children:r("updateProfile.description")})]}),e.jsx(L,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(D),className:"space-y-8",children:[e.jsx(d,{name:"email",render:()=>e.jsxs(o,{children:[e.jsx(m,{children:r("email")}),e.jsx(x,{className:"mt-2",children:e.jsx(p,{placeholder:"Email",disabled:!0,value:a==null?void 0:a.user.email})}),e.jsx(h,{children:r("registeredEmail")})]})}),e.jsx(d,{control:t.control,name:"username",render:({field:i})=>e.jsxs(o,{children:[e.jsx(m,{children:r("username")}),e.jsx(x,{className:"mt-2",children:e.jsx(p,{placeholder:"Username",...i})}),e.jsx(h,{children:r("usernameDescription")}),e.jsx(f,{})]})}),e.jsx(d,{control:t.control,name:"friend_id",render:({field:i})=>e.jsxs(o,{children:[e.jsx(m,{children:r("friendID")}),e.jsx(x,{className:"mt-2",children:e.jsx(p,{placeholder:"Friend ID",...i})}),e.jsx(h,{children:r("friendIDDescription")}),e.jsx(f,{})]})}),e.jsx(d,{control:t.control,name:"is_public",render:({field:i})=>e.jsxs(o,{className:"flex flex-col items-start",children:[e.jsx(x,{className:"mt-2",children:e.jsxs("div",{className:"flex items-center gap-x-2 w-full flex-wrap",children:[e.jsx(m,{children:r("isPublicToggle")}),e.jsx("div",{className:"grow-1",children:e.jsx(R,{checked:i.value,onCheckedChange:i.onChange})}),e.jsx(j,{disabled:!(s!=null&&s.is_public),onClick:async l=>{l.preventDefault(),c({title:"Copied public collection page URL to clipboard!",variant:"default",duration:3e3}),await navigator.clipboard.writeText(F)},children:r("isPublicButton")}),e.jsx(j,{disabled:!(s!=null&&s.is_public),onClick:async l=>{l.preventDefault(),b(!1),v(`/collection/${s==null?void 0:s.friend_id}/trade`)},children:r("isPublicTradeButton")})]})}),e.jsx(h,{children:r("isPublicDescription")})]})}),(s==null?void 0:s.is_public)&&e.jsx(z,{}),e.jsx(j,{type:"submit",children:r("save")})]})})]})})};export{O as default};
